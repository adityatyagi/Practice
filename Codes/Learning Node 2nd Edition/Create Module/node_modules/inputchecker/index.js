// Application modified to be a module object
var util = require('util');
var fs = require('fs');
var evenEmitter = require('events').EventEmitter;

exports.InputChecker = InputChecker;

// function constructor to create a object
function InputChecker(name, file) {
    this.name = name;
    this.writeStream = fs.createWriteStream('./' + file + '.txt', {
        'flags': 'a',
        'encoding': 'utf8',
        'mode': 0666
    });
};

util.inherits(InputChecker, evenEmitter);

InputChecker.prototype.check = function(input) {
    var command = input.toString().trim().substr(0, 3); // convert to string, trim the spaces and then get the command of 3 characters i.e from 0 to 2 indicies
    if (command == 'wr:') {
        this.emit('write', input.substr(3, input.length));
    } else if (command == 'en:') {
        this.emit('end');
    } else {
        this.emit('echo', input);
    }
};